<!--
 * @Author: your name
 * @Date: 2022-02-11 16:24:40
 * @LastEditTime: 2022-02-11 18:45:09
 * @LastEditors: Please set LastEditors
 * @Description: 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
 * @FilePath: /HTML-/function.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>常用页面交互方法</title>
</head>

<body>
  <input type="text" value="数据" id="input">
  <button id="send" onclick="send()">发送</button>
  <iframe src="https://www.runoob.com/js/met-win-postmessage.html" frameborder="0" id="frame"></iframe>

  <script>
    // Window.postMessage() 用于iframe标签与父标签或子标签的安全地实现跨源通信。
    /**
     * iframe标签作为子，传父
     * window.parent.postMessage({ 'type': 'lk', 'params': { id: '1' } }, '*');
    */
    /**
     * iframe标签作为父，传子
     * iframe标签DOM.contentWindow.postMessage({ id: '1' }, '*');
    */
    /**
     * 接收 postMessage
     * window.addEventListener("message", (event) => {
        if (event.origin !== window.location.origin) return;
        console.log(event);
      }, false);
    */

    const frame = document.getElementById('frame');
    const input = document.getElementById('input');
    function send() {
      window.postMessage({ 'name': '刘可', 'params': { id: '1' } }, '*');
      window.addEventListener('message', (e) => {
        console.log(e);
        input.value = e.data.name;
      })
    };

  </script>

</body>

</html>